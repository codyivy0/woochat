spring.application.name=woochat

# Database Configuration
# Will be overridden by DatabaseConfig for Railway deployment
spring.datasource.url=jdbc:postgresql://localhost:5432/chatdb
spring.datasource.username=chatuser
spring.datasource.password=chatpass

# Make database connection more resilient for Railway
spring.jpa.hibernate.ddl-auto=update
spring.jpa.show-sql=false
spring.jpa.properties.hibernate.dialect=org.hibernate.dialect.PostgreSQLDialect
spring.jpa.properties.hibernate.format_sql=false

# CRITICAL: Make database connection non-blocking for health checks
spring.jpa.defer-datasource-initialization=true
spring.sql.init.continue-on-error=true
spring.datasource.continue-on-error=true

# Database connection pool settings for Railway
spring.datasource.hikari.maximum-pool-size=5
spring.datasource.hikari.minimum-idle=1
spring.datasource.hikari.connection-timeout=20000
spring.datasource.hikari.idle-timeout=300000
spring.datasource.hikari.initialization-fail-timeout=-1

# Kafka Configuration
# Will be overridden by environment variables in Docker
spring.kafka.bootstrap-servers=${SPRING_KAFKA_BOOTSTRAP_SERVERS:localhost:9092}
# Make Kafka optional for Railway deployment
spring.kafka.producer.bootstrap-servers=${SPRING_KAFKA_BOOTSTRAP_SERVERS:localhost:9092}
spring.kafka.consumer.bootstrap-servers=${SPRING_KAFKA_BOOTSTRAP_SERVERS:localhost:9092}
# Auto-create topics if they don't exist
spring.kafka.producer.properties.spring.kafka.admin.auto-create=true
# Make Kafka startup non-blocking
spring.kafka.consumer.enable-auto-commit=false
spring.kafka.consumer.auto-offset-reset=earliest

# Google OAuth2 Resource Server Configuration
spring.security.oauth2.resourceserver.jwt.issuer-uri=https://accounts.google.com

server.port=${PORT:8080}

# Logging configuration
logging.level.org.springframework.security=DEBUG
logging.level.com.woochat=INFO

# Actuator endpoints for health checks
management.endpoints.web.exposure.include=health,info
management.endpoint.health.show-details=when-authorized
